# Fontions de l'API d'authentification - DEV ONLY (inclus sous /millegrilles en prod)

# Chargement de l'application React /millegrilles
location = /millegrilles {
 proxy_pass        http://mg-dev4.maple.maceroc.com:3002;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}
location = /millegrilles/sock-js.node {
 proxy_pass        http://mg-dev4.maple.maceroc.com:3002;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}
location /millegrilles/main. {
 proxy_pass        http://mg-dev4.maple.maceroc.com:3002;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}
location /millegrilles/static {
 proxy_pass        http://mg-dev4.maple.maceroc.com:3002;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}

# Chargement de /coupdoeil
location = /coupdoeil {
 # Protection via auth plugin
 include /etc/nginx/conf.d/auth.include;

 proxy_pass        https://mg-dev4.maple.maceroc.com:3004;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}
location /coupdoeil/main* {
 # Protection via auth plugin
 include /etc/nginx/conf.d/auth.include;

 proxy_pass        https://mg-dev4.maple.maceroc.com:3004;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}
location /coupdoeil/static {
 # Protection via auth plugin
 include /etc/nginx/conf.d/auth.include;

 proxy_pass        https://mg-dev4.maple.maceroc.com:3004;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;
}

# Site de test
location /prive {
 include           /etc/nginx/conf.d/auth.include;
 include           /etc/nginx/conf.d/modules/proxypass_millegrilles.include;
 proxy_set_header  X-Real-IP $remote_addr;
 proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header  X-Forwarded-Proto $scheme;

 proxy_set_header  Remote-User $auth_user;
 proxy_set_header  Est-Proprietaire $auth_proprietaire;
}
